# Quick Start Guide: Claude Code Launcher Plugin

**Feature Branch**: `001-claude-code-launcher`
**Date**: 2026-02-11

This guide helps developers get started building the Claude Code Launcher plugin for Obsidian.

---

## Prerequisites

- **Node.js**: Version 18+ (LTS recommended)
- **npm**: Version 8+ (comes with Node.js)
- **Obsidian**: Desktop version (macOS, Windows, or Linux)
- **Claude Code CLI**: Installed and accessible in PATH
- **Git**: For version control
- **TypeScript knowledge**: Familiarity with TypeScript and async/await patterns
- **Code editor**: VS Code recommended (with TypeScript support)

---

## Development Environment Setup

### 1. Initialize Project

```bash
# Navigate to your Obsidian plugins directory
cd /path/to/your/vault/.obsidian/plugins

# Create plugin directory
mkdir obsidian-cc-launch
cd obsidian-cc-launch

# Initialize git repository
git init
git checkout -b 001-claude-code-launcher
```

### 2. Create Basic Project Structure

```bash
# Create source directory
mkdir -p src/commands src/utils

# Create root files
touch manifest.json
touch esbuild.config.mjs
touch tsconfig.json
touch package.json
touch .gitignore
touch README.md

# Create source files
touch src/main.ts
touch src/settings.ts
touch src/types.ts
touch src/commands/launch-claude.ts
touch src/utils/terminal.ts
```

### 3. Install Dependencies

```bash
# Initialize package.json
npm init -y

# Install Obsidian API types
npm install --save-dev obsidian

# Install TypeScript
npm install --save-dev typescript

# Install esbuild for bundling
npm install --save-dev esbuild

# Install Node.js types
npm install --save-dev @types/node
```

---

## Configuration Files

### manifest.json

```json
{
  "id": "obsidian-cc-launch",
  "name": "Claude Code Launcher",
  "version": "1.0.0",
  "minAppVersion": "1.0.0",
  "description": "Launch Claude Code from CLAUDE.md files in your vault",
  "author": "Your Name",
  "authorUrl": "https://github.com/yourusername",
  "isDesktopOnly": true
}
```

### package.json

```json
{
  "name": "obsidian-cc-launch",
  "version": "1.0.0",
  "description": "Obsidian plugin to launch Claude Code from CLAUDE.md files",
  "main": "main.js",
  "scripts": {
    "dev": "node esbuild.config.mjs",
    "build": "tsc -noEmit -skipLibCheck && node esbuild.config.mjs production"
  },
  "keywords": ["obsidian", "plugin", "claude-code", "terminal"],
  "author": "Your Name",
  "license": "MIT",
  "devDependencies": {
    "@types/node": "^20.0.0",
    "obsidian": "latest",
    "typescript": "^5.0.0",
    "esbuild": "^0.19.0"
  }
}
```

### tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "lib": ["ES2020", "DOM"],
    "strict": true,
    "moduleResolution": "node",
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "outDir": "dist",
    "rootDir": "src",
    "baseUrl": ".",
    "paths": {
      "obsidian": ["node_modules/obsidian/obsidian.d.ts"]
    }
  },
  "include": ["src/**/*.ts"],
  "exclude": ["node_modules"]
}
```

### esbuild.config.mjs

```javascript
import esbuild from "esbuild";
import process from "process";

const banner = `/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/
`;

const prod = process.argv[2] === "production";

esbuild.build({
  banner: {
    js: banner,
  },
  entryPoints: ["src/main.ts"],
  bundle: true,
  external: ["obsidian"],
  format: "cjs",
  target: "es2020",
  logLevel: "info",
  sourcemap: prod ? false : "inline",
  treeShaking: true,
  outfile: "main.js",
  watch: !prod,
}).catch(() => process.exit(1));
```

### .gitignore

```gitignore
# Node modules
node_modules/

# Build artifacts
main.js
*.js
!esbuild.config.mjs

# Development
dist/
*.log
.DS_Store

# IDE
.vscode/
.idea/
```

---

## Implementation Checklist

### Phase 1: Foundation

- [ ] Create project structure
- [ ] Configure TypeScript with strict mode
- [ ] Configure esbuild for bundling
- [ ] Create manifest.json with correct metadata
- [ ] Set up npm scripts (dev, build)

### Phase 2: Core Types & Settings

- [ ] Define `LauncherSettings` interface in `types.ts`
- [ ] Define `LaunchContext` interface in `types.ts`
- [ ] Define `LaunchResult` interface in `types.ts`
- [ ] Implement `getDefaultSettings()` in `settings.ts`
- [ ] Implement `LauncherSettingTab` class in `settings.ts`

### Phase 3: Terminal Utilities

- [ ] Implement `buildLaunchContext()` in `utils/terminal.ts`
- [ ] Implement `spawnTerminal()` in `utils/terminal.ts`
- [ ] Implement `launchTerminal()` in `utils/terminal.ts`
- [ ] Add path validation helper functions
- [ ] Add error handling and logging

### Phase 4: Command Logic

- [ ] Implement `registerLaunchCommand()` in `commands/launch-claude.ts`
- [ ] Implement file-menu event handler
- [ ] Implement editor-menu event handler
- [ ] Implement `launchClaudeCode()` function
- [ ] Add user notifications (success/error)

### Phase 5: Plugin Lifecycle

- [ ] Implement `ClaudeCodeLauncherPlugin` class in `main.ts`
- [ ] Implement `onload()` method
- [ ] Implement `loadSettings()` method
- [ ] Implement `saveSettings()` method
- [ ] Register settings tab
- [ ] Register command handlers

### Phase 6: Testing

- [ ] Test on macOS with Terminal.app
- [ ] Test on Windows with cmd.exe
- [ ] Test on Linux with gnome-terminal
- [ ] Test with spaces in paths
- [ ] Test error conditions (Claude Code not installed)
- [ ] Test multiple CLAUDE.md files
- [ ] Test settings changes

### Phase 7: Documentation

- [ ] Write README.md with installation instructions
- [ ] Document settings and configuration
- [ ] Add troubleshooting section
- [ ] Create example CLAUDE.md file

---

## Development Workflow

### 1. Start Development Build

```bash
npm run dev
```

This starts esbuild in watch mode. Changes to TypeScript files will automatically trigger a rebuild.

### 2. Test in Obsidian

- Open Obsidian
- Enable Community Plugins
- Enable Developer mode in Settings â†’ Community plugins
- Reload Obsidian (or use Ctrl/Cmd + R)
- Check Console (Ctrl/Cmd + Shift + I) for errors

### 3. Make Changes

1. Edit TypeScript files in `src/`
2. esbuild automatically rebuilds `main.js`
3. Reload Obsidian to see changes
4. Check console for errors or logs

### 4. Debug Issues

**Enable Debug Logging**:

```typescript
console.log('Debug info:', someVariable);
```

**Check Console**:
- Open Developer Tools (Ctrl/Cmd + Shift + I)
- Look for errors in Console tab
- Check Network tab for failed requests (if any)

**Common Issues**:
- **"Cannot find module"**: Check imports and tsconfig.json paths
- **"Plugin failed to load"**: Check syntax errors, missing exports
- **"spawn ENOENT"**: Claude Code not in PATH or terminal command incorrect

### 5. Build for Production

```bash
npm run build
```

This creates an optimized `main.js` without source maps.

---

## Testing Strategy

### Manual Testing Checklist

#### Basic Functionality
- [ ] Right-click CLAUDE.md in file explorer â†’ "Launch Claude Code" appears
- [ ] Right-click CLAUDE.md editor tab â†’ "Launch Claude Code" appears
- [ ] Click "Launch Claude Code" â†’ Terminal opens
- [ ] Terminal working directory is correct (directory containing CLAUDE.md)
- [ ] Claude Code runs in terminal

#### Multiple Files
- [ ] Create CLAUDE.md in vault root
- [ ] Create CLAUDE.md in subfolder
- [ ] Launch from both â†’ Each opens in correct directory

#### Settings
- [ ] Open plugin settings
- [ ] Change terminal command
- [ ] Launch Claude Code â†’ Uses new settings
- [ ] Reset to defaults â†’ Works correctly

#### Error Handling
- [ ] Remove Claude Code from PATH â†’ Error notice appears
- [ ] Use invalid terminal command â†’ Error notice appears
- [ ] Right-click folder named CLAUDE.md â†’ Menu item doesn't appear

#### Platform-Specific
- [ ] Test on macOS (Terminal.app or iTerm2)
- [ ] Test on Windows (cmd.exe or Windows Terminal)
- [ ] Test on Linux (gnome-terminal, konsole, or xterm)

#### Edge Cases
- [ ] Path with spaces in directory name
- [ ] Vault in non-standard location
- [ ] Multiple Obsidian vaults open simultaneously

---

## Architecture Overview

```
src/
â”œâ”€â”€ main.ts                     # Plugin lifecycle (onload, onunload)
â”‚   â””â”€â”€ ClaudeCodeLauncherPlugin class
â”‚       â”œâ”€â”€ onload()            # Initialize plugin
â”‚       â”œâ”€â”€ onunload()          # Cleanup (automatic)
â”‚       â”œâ”€â”€ loadSettings()      # Load from data.json
â”‚       â””â”€â”€ saveSettings()      # Save to data.json
â”‚
â”œâ”€â”€ settings.ts                 # Settings management
â”‚   â”œâ”€â”€ LauncherSettings        # Interface
â”‚   â”œâ”€â”€ getDefaultSettings()    # Platform defaults
â”‚   â””â”€â”€ LauncherSettingTab      # UI
â”‚
â”œâ”€â”€ types.ts                    # Type definitions
â”‚   â”œâ”€â”€ LauncherSettings
â”‚   â”œâ”€â”€ LaunchContext
â”‚   â”œâ”€â”€ LaunchResult
â”‚   â””â”€â”€ Platform types
â”‚
â”œâ”€â”€ commands/
â”‚   â””â”€â”€ launch-claude.ts        # Command logic
â”‚       â”œâ”€â”€ registerLaunchCommand()
â”‚       â””â”€â”€ launchClaudeCode()
â”‚
â””â”€â”€ utils/
    â””â”€â”€ terminal.ts             # Terminal spawning
        â”œâ”€â”€ buildLaunchContext()
        â”œâ”€â”€ launchTerminal()
        â””â”€â”€ spawnTerminal()
```

---

## Key Implementation Notes

### 1. Use `registerEvent()` for Cleanup

Always register events using `this.registerEvent()`:

```typescript
this.registerEvent(
  this.app.workspace.on("file-menu", (menu, file) => {
    // Handler code
  })
);
```

This ensures automatic cleanup on plugin unload.

### 2. Check File Type Before Operations

```typescript
if (!(file instanceof TFile)) return;
```

Prevents crashes when users right-click folders.

### 3. Use Absolute Paths

```typescript
const adapter = this.app.vault.adapter;
if (adapter instanceof FileSystemAdapter) {
  const vaultPath = adapter.getBasePath();
  const absolutePath = path.join(vaultPath, file.parent?.path || '');
}
```

### 4. Platform Detection

```typescript
const platform = process.platform; // 'darwin' | 'win32' | 'linux'
```

### 5. Spawn Detached Processes

```typescript
const child = spawn(command, args, {
  detached: true,
  stdio: 'ignore',
  windowsHide: true,
  shell: false
});

child.unref();
```

### 6. Handle Errors Gracefully

```typescript
try {
  await launchTerminal(context);
  new Notice('Claude Code launched successfully');
} catch (error) {
  new Notice(`Failed to launch: ${error.message}`);
  console.error('Launch error:', error);
}
```

---

## Troubleshooting

### Problem: Plugin doesn't appear in Obsidian

**Solution**:
1. Check manifest.json is valid JSON
2. Ensure main.js exists (run `npm run build`)
3. Reload Obsidian (Ctrl/Cmd + R)
4. Check console for errors

### Problem: Context menu item doesn't appear

**Solution**:
1. Ensure file is named exactly "CLAUDE.md" (case-insensitive)
2. Check if file is a TFile (not a folder)
3. Check console for registration errors
4. Verify event handler is registered in onload()

### Problem: Terminal doesn't open

**Solution**:
1. Check Claude Code is installed: `which claude-code` (Unix) or `where claude-code` (Windows)
2. Verify terminal command in settings
3. Check console for spawn errors
4. Try manually running the command in a terminal
5. Ensure plugin is set to `isDesktopOnly: true` in manifest.json

### Problem: Wrong working directory

**Solution**:
1. Verify `file.parent?.path` is correct
2. Check `adapter.getBasePath()` returns vault path
3. Ensure paths are joined correctly with `path.join()`
4. Log the final path to console for debugging

---

## Performance Tips

1. **Early return**: Exit handlers quickly for non-matching files
2. **Lazy loading**: Don't load heavy dependencies until needed
3. **Async operations**: Use async/await for file operations
4. **Minimal state**: Store only settings, no caching
5. **Detached spawning**: Don't wait for terminal to finish

---

## Next Steps

After completing MVP:

1. **Testing**: Comprehensive testing on all platforms
2. **Documentation**: Complete README with screenshots
3. **Release**: Package for Obsidian community plugins
4. **Future Features**:
   - Support for custom template variables
   - Launch history/recent launches
   - Per-folder configuration overrides
   - Support for other AI coding assistants

---

## Resources

- [Obsidian API Documentation](https://docs.obsidian.md/)
- [Obsidian Plugin Developer Docs](https://marcus.se.net/obsidian-plugin-docs/)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [esbuild Documentation](https://esbuild.github.io/)
- [Node.js Child Process API](https://nodejs.org/api/child_process.html)
- [Obsidian Community Plugins](https://obsidian.md/plugins)

---

## Support & Contribution

- **Issues**: [GitHub Issues](https://github.com/yourusername/obsidian-cc-launch/issues)
- **Discussions**: [GitHub Discussions](https://github.com/yourusername/obsidian-cc-launch/discussions)
- **Contributing**: See CONTRIBUTING.md (when available)

---

**Happy Coding!** ðŸš€
